{"ast":null,"code":"import _createClass from \"@babel/runtime/helpers/createClass\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport { PermissionStatus, EventEmitter, Platform } from 'expo-modules-core';\n\nvar DeviceSensor = _createClass(function DeviceSensor(nativeSensorModule, nativeEventName) {\n  var _this = this;\n\n  _classCallCheck(this, DeviceSensor);\n\n  this.addListener = function (listener) {\n    var subscription = _this._nativeEmitter.addListener(_this._nativeEventName, listener);\n\n    subscription.remove = function () {\n      return _this.removeSubscription(subscription);\n    };\n\n    _this._listenerCount++;\n    return subscription;\n  };\n\n  this.hasListeners = function () {\n    return _this._listenerCount > 0;\n  };\n\n  this.getListenerCount = function () {\n    return _this._listenerCount;\n  };\n\n  this.removeAllListeners = function () {\n    _this._listenerCount = 0;\n\n    _this._nativeEmitter.removeAllListeners(_this._nativeEventName);\n  };\n\n  this.removeSubscription = function (subscription) {\n    _this._listenerCount--;\n\n    _this._nativeEmitter.removeSubscription(subscription);\n  };\n\n  this.setUpdateInterval = function (intervalMs) {\n    if (!_this._nativeModule.setUpdateInterval) {\n      console.warn(\"expo-sensors: setUpdateInterval() is not supported on \" + Platform.OS);\n    } else {\n      _this._nativeModule.setUpdateInterval(intervalMs);\n    }\n  };\n\n  this.isAvailableAsync = function _callee() {\n    return _regeneratorRuntime.async(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (_this._nativeModule.isAvailableAsync) {\n              _context.next = 4;\n              break;\n            }\n\n            return _context.abrupt(\"return\", false);\n\n          case 4:\n            _context.next = 6;\n            return _regeneratorRuntime.awrap(_this._nativeModule.isAvailableAsync());\n\n          case 6:\n            return _context.abrupt(\"return\", _context.sent);\n\n          case 7:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  this.getPermissionsAsync = function _callee2() {\n    return _regeneratorRuntime.async(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            if (_this._nativeModule.getPermissionsAsync) {\n              _context2.next = 4;\n              break;\n            }\n\n            return _context2.abrupt(\"return\", defaultPermissionsResponse);\n\n          case 4:\n            _context2.next = 6;\n            return _regeneratorRuntime.awrap(_this._nativeModule.getPermissionsAsync());\n\n          case 6:\n            return _context2.abrupt(\"return\", _context2.sent);\n\n          case 7:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  this.requestPermissionsAsync = function _callee3() {\n    return _regeneratorRuntime.async(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            if (_this._nativeModule.requestPermissionsAsync) {\n              _context3.next = 4;\n              break;\n            }\n\n            return _context3.abrupt(\"return\", defaultPermissionsResponse);\n\n          case 4:\n            _context3.next = 6;\n            return _regeneratorRuntime.awrap(_this._nativeModule.requestPermissionsAsync());\n\n          case 6:\n            return _context3.abrupt(\"return\", _context3.sent);\n\n          case 7:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  this._nativeModule = nativeSensorModule;\n  this._nativeEmitter = new EventEmitter(nativeSensorModule);\n  this._nativeEventName = nativeEventName;\n  this._listenerCount = 0;\n});\n\nexport { DeviceSensor as default };\nvar defaultPermissionsResponse = {\n  granted: true,\n  expires: 'never',\n  canAskAgain: true,\n  status: PermissionStatus.GRANTED\n};","map":{"version":3,"sources":["../src/DeviceSensor.ts"],"names":[],"mappings":";;;AAAA,SAEE,gBAFF,EAGE,YAHF,EAKE,QALF,QAMO,mBANP;;IAgBqB,Y,gBAMnB,sBAAY,kBAAZ,EAAoD,eAApD,EAA2E;EAAA;;EAAA;;EAAA,KAQ3E,WAR2E,GAQ7D,UAAC,QAAD,EAAwC;IACpD,IAAM,YAAY,GAAG,KAAI,CAAC,cAAL,CAAoB,WAApB,CAAgC,KAAI,CAAC,gBAArC,EAAuD,QAAvD,CAArB;;IACA,YAAY,CAAC,MAAb,GAAsB;MAAA,OAAM,KAAI,CAAC,kBAAL,CAAwB,YAAxB,CAAN;IAAA,CAAtB;;IACA,KAAI,CAAC,cAAL;IACA,OAAO,YAAP;EACD,CAb0E;;EAAA,KAe3E,YAf2E,GAe5D,YAAc;IAC3B,OAAO,KAAI,CAAC,cAAL,GAAsB,CAA7B;EACD,CAjB0E;;EAAA,KAmB3E,gBAnB2E,GAmBxD,YAAa;IAC9B,OAAO,KAAI,CAAC,cAAZ;EACD,CArB0E;;EAAA,KAuB3E,kBAvB2E,GAuBtD,YAAW;IAC9B,KAAI,CAAC,cAAL,GAAsB,CAAtB;;IACA,KAAI,CAAC,cAAL,CAAoB,kBAApB,CAAuC,KAAI,CAAC,gBAA5C;EACD,CA1B0E;;EAAA,KA4B3E,kBA5B2E,GA4BtD,UAAC,YAAD,EAAqC;IACxD,KAAI,CAAC,cAAL;;IACA,KAAI,CAAC,cAAL,CAAoB,kBAApB,CAAuC,YAAvC;EACD,CA/B0E;;EAAA,KAiC3E,iBAjC2E,GAiCvD,UAAC,UAAD,EAA6B;IAC/C,IAAI,CAAC,KAAI,CAAC,aAAL,CAAmB,iBAAxB,EAA2C;MACzC,OAAO,CAAC,IAAR,4DAAsE,QAAQ,CAAC,EAA/E;IACD,CAFD,MAEO;MACL,KAAI,CAAC,aAAL,CAAmB,iBAAnB,CAAqC,UAArC;IACD;EACF,CAvC0E;;EAAA,KAyC3E,gBAzC2E,GAyCxD;IAAA;MAAA;QAAA;UAAA;YAAA,IACZ,KAAI,CAAC,aAAL,CAAmB,gBADP;cAAA;cAAA;YAAA;;YAAA,iCAER,KAFQ;;UAAA;YAAA;YAAA,iCAIF,KAAI,CAAC,aAAL,CAAmB,gBAAnB,EAJE;;UAAA;YAAA;;UAAA;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAzCwD;;EAAA,KAiD3E,mBAjD2E,GAiDrD;IAAA;MAAA;QAAA;UAAA;YAAA,IACf,KAAI,CAAC,aAAL,CAAmB,mBADJ;cAAA;cAAA;YAAA;;YAAA,kCAEX,0BAFW;;UAAA;YAAA;YAAA,iCAIL,KAAI,CAAC,aAAL,CAAmB,mBAAnB,EAJK;;UAAA;YAAA;;UAAA;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAjDqD;;EAAA,KAyD3E,uBAzD2E,GAyDjD;IAAA;MAAA;QAAA;UAAA;YAAA,IACnB,KAAI,CAAC,aAAL,CAAmB,uBADA;cAAA;cAAA;YAAA;;YAAA,kCAEf,0BAFe;;UAAA;YAAA;YAAA,iCAIT,KAAI,CAAC,aAAL,CAAmB,uBAAnB,EAJS;;UAAA;YAAA;;UAAA;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAzDiD;;EACzE,KAAK,aAAL,GAAqB,kBAArB;EAEA,KAAK,cAAL,GAAsB,IAAI,YAAJ,CAAiB,kBAAjB,CAAtB;EACA,KAAK,gBAAL,GAAwB,eAAxB;EACA,KAAK,cAAL,GAAsB,CAAtB;AACD,C;;SAZkB,Y;AAwErB,IAAM,0BAA0B,GAAuB;EACrD,OAAO,EAAE,IAD4C;EAErD,OAAO,EAAE,OAF4C;EAGrD,WAAW,EAAE,IAHwC;EAIrD,MAAM,EAAE,gBAAgB,CAAC;AAJ4B,CAAvD","sourcesContent":["import {\n  PermissionResponse,\n  PermissionStatus,\n  EventEmitter,\n  Subscription,\n  Platform,\n} from 'expo-modules-core';\n\ntype Listener<E> = (event: E) => void;\n\ntype NativeSensorModule = any;\n\n/**\n * A base class for subscribable sensors. The events emitted by this class are measurements\n * specified by the parameter type `M`.\n */\nexport default class DeviceSensor<M> {\n  _nativeModule: NativeSensorModule;\n  _nativeEmitter: EventEmitter;\n  _nativeEventName: string;\n  _listenerCount: number;\n\n  constructor(nativeSensorModule: NativeSensorModule, nativeEventName: string) {\n    this._nativeModule = nativeSensorModule;\n\n    this._nativeEmitter = new EventEmitter(nativeSensorModule);\n    this._nativeEventName = nativeEventName;\n    this._listenerCount = 0;\n  }\n\n  addListener = (listener: Listener<M>): Subscription => {\n    const subscription = this._nativeEmitter.addListener(this._nativeEventName, listener);\n    subscription.remove = () => this.removeSubscription(subscription);\n    this._listenerCount++;\n    return subscription;\n  };\n\n  hasListeners = (): boolean => {\n    return this._listenerCount > 0;\n  };\n\n  getListenerCount = (): number => {\n    return this._listenerCount;\n  };\n\n  removeAllListeners = (): void => {\n    this._listenerCount = 0;\n    this._nativeEmitter.removeAllListeners(this._nativeEventName);\n  };\n\n  removeSubscription = (subscription: Subscription): void => {\n    this._listenerCount--;\n    this._nativeEmitter.removeSubscription(subscription);\n  };\n\n  setUpdateInterval = (intervalMs: number): void => {\n    if (!this._nativeModule.setUpdateInterval) {\n      console.warn(`expo-sensors: setUpdateInterval() is not supported on ${Platform.OS}`);\n    } else {\n      this._nativeModule.setUpdateInterval(intervalMs);\n    }\n  };\n\n  isAvailableAsync = async (): Promise<boolean> => {\n    if (!this._nativeModule.isAvailableAsync) {\n      return false;\n    } else {\n      return await this._nativeModule.isAvailableAsync();\n    }\n  };\n\n  getPermissionsAsync = async (): Promise<PermissionResponse> => {\n    if (!this._nativeModule.getPermissionsAsync) {\n      return defaultPermissionsResponse;\n    } else {\n      return await this._nativeModule.getPermissionsAsync();\n    }\n  };\n\n  requestPermissionsAsync = async (): Promise<PermissionResponse> => {\n    if (!this._nativeModule.requestPermissionsAsync) {\n      return defaultPermissionsResponse;\n    } else {\n      return await this._nativeModule.requestPermissionsAsync();\n    }\n  };\n}\n\nconst defaultPermissionsResponse: PermissionResponse = {\n  granted: true,\n  expires: 'never',\n  canAskAgain: true,\n  status: PermissionStatus.GRANTED,\n};\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}